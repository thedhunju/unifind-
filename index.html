<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#6366f1">
  <title>UNI-find - Kathmandu University Student Marketplace</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* ===== CSS Variables ===== */
    :root {
      --primary-color: #6366f1;
      --primary-dark: #4f46e5;
      --primary-light: #818cf8;
      --secondary-color: #ec4899;
      --success-color: #10b981;
      --danger-color: #ef4444;
      --dark: #1e293b;
      --dark-light: #334155;
      --gray: #64748b;
      --gray-light: #cbd5e1;
      --gray-lighter: #f1f5f9;
      --white: #ffffff;
      --shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.1);
      --border-radius: 12px;
      --transition: all 0.3s ease;
    }

    /* ===== Reset & Base Styles ===== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background-color: var(--gray-lighter);
      color: var(--dark);
      line-height: 1.6;
      overflow-x: hidden;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    /* ===== Header ===== */
    .header {
      background-color: var(--white);
      box-shadow: var(--shadow);
      position: sticky;
      top: 0;
      z-index: 1000;
      padding: 1rem 0;
    }
    .header-content {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 2rem;
    }
    .logo {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 1.5rem;
      font-weight: 800;
      color: var(--primary-color);
      text-decoration: none;
    }

    /* ===== Buttons ===== */
    .btn {
      background: var(--primary-color);
      color: var(--white);
      border: none;
      border-radius: var(--border-radius);
      padding: 0.7rem 2rem;
      font-size: 1.1rem;
      font-weight: 700;
      cursor: pointer;
      box-shadow: var(--shadow);
      transition: background var(--transition), transform var(--transition);
    }
    .btn:hover {
      background: var(--primary-dark);
      transform: translateY(-2px);
    }
    .btn:focus {
      outline: 3px solid var(--primary-color);
      outline-offset: 2px;
    }
    .filter-btn {
      background: var(--gray-light);
      color: var(--dark);
      border: none;
      border-radius: var(--border-radius);
      padding: 0.5rem 1.2rem;
      font-weight: 600;
      margin: 0 0.3rem 0.3rem 0;
      cursor: pointer;
      transition: background var(--transition), color var(--transition);
    }
    .filter-btn.active,
    .filter-btn:hover {
      background: var(--secondary-color);
      color: var(--white);
    }

    /* ===== Hero Section ===== */
    .hero {
      background-color: var(--white);
      border-bottom: 1px solid var(--gray-light);
      padding: 2rem 0 1.5rem 0;
      text-align: center;
    }
    .hero-title {
      font-size: 2.5rem;
      font-weight: 800;
      color: var(--primary-dark);
      margin-bottom: 0.5rem;
    }
    .hero-subtitle {
      font-size: 1.3rem;
      color: var(--dark-light);
      margin-bottom: 1rem;
    }
    .search-bar {
      display: flex;
      align-items: center;
      max-width: 600px;
      margin: 0 auto;
      background: var(--gray-lighter);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      padding: 0.4rem 0.8rem;
      gap: 0.5rem;
    }
    .search-icon {
      color: var(--gray);
      font-size: 1.3rem;
    }
    .search-bar input, .category-select {
      border: none;
      outline: none;
      font-size: 1rem;
      padding: 0.6rem 1rem;
      background: var(--white);
      border-radius: var(--border-radius);
      flex: 1;
    }

    /* ===== Sections ===== */
    .section-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
      margin: 2rem 0 1rem 0;
    }

    /* ===== Items Grid ===== */
    .items-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 2rem;
      margin: 2rem 0;
    }
    .item-card {
      background: var(--white);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      overflow: hidden;
      transition: box-shadow var(--transition), transform var(--transition);
      cursor: pointer;
    }
    .item-card:hover {
      box-shadow: var(--shadow-lg);
      transform: translateY(-4px);
    }
    .item-image {
      width: 100%;
      height: 200px;
      background: var(--gray-lighter);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 3rem;
      color: var(--gray-light);
    }
    .item-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .item-info {
      padding: 1.2rem;
    }
    .item-title {
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--primary-dark);
      margin-bottom: 0.5rem;
    }
    .item-price {
      font-size: 1.3rem;
      font-weight: 700;
      color: var(--secondary-color);
      margin-bottom: 0.5rem;
    }
    .item-category {
      display: inline-block;
      background: var(--primary-light);
      color: var(--white);
      padding: 0.3rem 0.8rem;
      border-radius: 20px;
      font-size: 0.85rem;
      margin-bottom: 0.5rem;
    }
    .item-status {
      display: inline-block;
      padding: 0.3rem 0.8rem;
      border-radius: 20px;
      font-size: 0.85rem;
      margin-left: 0.5rem;
      font-weight: 600;
    }
    .item-status.available {
      background: var(--success-color);
      color: var(--white);
    }
    .item-status.sold {
      background: var(--gray-light);
      color: var(--white);
    }
    .item-desc {
      color: var(--dark-light);
      font-size: 0.95rem;
      margin-bottom: 0.8rem;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    .item-meta {
      font-size: 0.85rem;
      color: var(--gray);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    /* ===== Modal ===== */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0,0,0,0.6);
      z-index: 2000;
      align-items: center;
      justify-content: center;
      animation: fadeIn 0.3s ease;
    }
    .modal.active {
      display: flex;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    .modal-content {
      background: var(--white);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-lg);
      padding: 2rem;
      max-width: 600px;
      width: 95%;
      max-height: 90vh;
      overflow-y: auto;
      animation: slideUp 0.3s ease;
      position: relative;
    }
    @keyframes slideUp {
      from { transform: translateY(50px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    .close-modal {
      position: absolute;
      top: 1rem;
      right: 1.5rem;
      background: none;
      border: none;
      color: var(--dark);
      font-size: 2rem;
      cursor: pointer;
      line-height: 1;
    }
    .close-modal:hover {
      color: var(--danger-color);
    }
    .modal h2 {
      color: var(--primary-dark);
      margin-bottom: 1.5rem;
    }
    .form-group {
      margin-bottom: 1.2rem;
    }
    .form-group label {
      display: block;
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: var(--dark);
    }
    .form-group input,
    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: 0.7rem;
      border: 2px solid var(--gray-light);
      border-radius: var(--border-radius);
      font-size: 1rem;
      font-family: inherit;
      transition: border var(--transition);
    }
    .form-group input:focus,
    .form-group textarea:focus,
    .form-group select:focus {
      outline: none;
      border-color: var(--primary-color);
    }
    .form-group textarea {
      resize: vertical;
      min-height: 100px;
    }

    /* ===== Loading and Empty State ===== */
    .loading, .empty-state {
      text-align: center;
      padding: 4rem 2rem;
    }
    .loading i, .empty-state i {
      font-size: 3rem;
      color: var(--gray-light);
      margin-bottom: 1rem;
    }
    .empty-state h3 {
      color: var(--gray);
      margin-bottom: 0.5rem;
    }
    .empty-state p {
      color: var(--gray-light);
    }
    .loading {
      display: none;
    }
    .empty-state {
      display: none;
    }

    /* ===== Toast Notifications ===== */
    .toast {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      background: var(--success-color);
      color: var(--white);
      padding: 1rem 1.5rem;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-lg);
      animation: slideIn 0.3s ease;
      z-index: 3000;
    }
    .toast.error {
      background: var(--danger-color);
    }
    @keyframes slideIn {
      from { transform: translateX(400px); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    /* ===== Footer ===== */
    .footer {
      background: var(--dark);
      padding: 2rem 0;
      color: var(--gray-light);
      text-align: center;
      margin-top: 4rem;
    }
    .footer-links {
      display: flex;
      gap: 2rem;
      justify-content: center;
      margin-top: 1rem;
    }
    .footer-links a {
      color: var(--primary-light);
      text-decoration: none;
      font-weight: 600;
    }

    /* ===== Responsive ===== */
    @media (max-width: 768px) {
      .header-content, .section-header {
        flex-direction: column;
        gap: 1rem;
      }
      .items-grid {
        grid-template-columns: 1fr;
        gap: 1.5rem;
      }
      .hero-title { font-size: 2rem; }
      .search-bar {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <header class="header">
    <div class="container header-content">
      <a class="logo" href="/" aria-label="Home">
        <i class="fas fa-graduation-cap"></i>
        <span>UNI-find</span>
      </a>
      <button class="btn" id="postItemBtn" aria-label="Post New Item">
        <i class="fas fa-plus"></i> Post Item
      </button>
    </div>
  </header>

  <main>
    <section class="hero">
      <div class="container">
        <h1 class="hero-title">Welcome to UNI-find</h1>
        <p class="hero-subtitle">Kathmandu University's Student Marketplace</p>
        <div class="search-bar">
          <i class="fas fa-search search-icon"></i>
          <input id="searchInput" type="text" placeholder="Search items..." aria-label="Search for items">
          <select class="category-select" id="categorySelect" aria-label="Filter by category">
            <option value="">All Categories</option>
            <option value="Electronics">Electronics</option>
            <option value="Books">Books</option>
            <option value="Furniture">Furniture</option>
            <option value="Clothing">Clothing</option>
            <option value="Sports">Sports</option>
            <option value="Stationery">Stationery</option>
            <option value="Other">Other</option>
          </select>
        </div>
      </div>
    </section>

    <section class="main-content container">
      <div class="section-header">
        <h2><i class="fas fa-store"></i> Marketplace</h2>
        <div class="filter-buttons" role="group" aria-label="Marketplace filters">
          <button class="filter-btn active" data-filter="all">All Items</button>
          <button class="filter-btn" data-filter="available">Available</button>
          <button class="filter-btn" data-filter="sold">Sold</button>
        </div>
      </div>
      <div class="items-grid" id="marketplaceGrid" aria-live="polite"></div>
      <div class="loading" id="marketplaceLoading">
        <i class="fas fa-spinner fa-spin"></i>
        <p>Loading items...</p>
      </div>
      <div class="empty-state" id="marketplaceEmpty">
        <i class="fas fa-inbox"></i>
        <h3>No items found</h3>
        <p>Be the first to post an item!</p>
        <button class="btn" style="margin-top: 1rem;" onclick="openPostModal()">Post an Item</button>
      </div>
    </section>
  </main>

  <!-- Post Item Modal -->
  <div class="modal" id="postModal" aria-modal="true" role="dialog">
    <div class="modal-content">
      <button class="close-modal" aria-label="Close Modal" onclick="closeModals()">&times;</button>
      <h2><i class="fas fa-plus-circle"></i> Post New Item</h2>
      <form id="postItemForm">
        <div class="form-group">
          <label for="itemTitle">Item Title *</label>
          <input type="text" id="itemTitle" required placeholder="e.g., iPhone 13 Pro">
        </div>
        <div class="form-group">
          <label for="itemPrice">Price (NPR) *</label>
          <input type="number" id="itemPrice" required placeholder="e.g., 5000" min="0">
        </div>
        <div class="form-group">
          <label for="itemCategory">Category *</label>
          <select id="itemCategory" required>
            <option value="">Select Category</option>
            <option value="Electronics">Electronics</option>
            <option value="Books">Books</option>
            <option value="Furniture">Furniture</option>
            <option value="Clothing">Clothing</option>
            <option value="Sports">Sports</option>
            <option value="Stationery">Stationery</option>
            <option value="Other">Other</option>
          </select>
        </div>
        <div class="form-group">
          <label for="itemDescription">Description *</label>
          <textarea id="itemDescription" required placeholder="Describe your item..."></textarea>
        </div>
        <div class="form-group">
          <label for="itemImage">Image URL (optional)</label>
          <input type="url" id="itemImage" placeholder="https://example.com/image.jpg">
        </div>
        <div class="form-group">
          <label for="contactInfo">Contact Info *</label>
          <input type="text" id="contactInfo" required placeholder="Email or Phone">
        </div>
        <button type="submit" class="btn" style="width: 100%;">
          <i class="fas fa-paper-plane"></i> Post Item
        </button>
      </form>
    </div>
  </div>

  <!-- Item Detail Modal -->
  <div class="modal" id="detailModal" aria-modal="true" role="dialog">
    <div class="modal-content" id="detailContent">
      <button class="close-modal" aria-label="Close Modal" onclick="closeModals()">&times;</button>
      <!-- Details will be injected here -->
    </div>
  </div>

  <footer class="footer">
    <div class="container">
      <p>&copy; 2025 UNI-find. All rights reserved.</p>
      <div class="footer-links">
        <a href="#about">About</a>
        <a href="#contact">Contact</a>
        <a href="#privacy">Privacy Policy</a>
      </div>
    </div>
  </footer>

  <script>
    // ===== Global State =====
    let marketplaceItems = [];
    let currentFilter = "all";
    let searchQuery = "";
    let categoryFilter = "";

    // ===== Mock Data (Remove this when connecting to real API) =====
    const mockData = [
      {
        id: 1,
        title: "MacBook Pro 2020",
        price: 85000,
        category: "Electronics",
        description: "Barely used MacBook Pro 13-inch, 8GB RAM, 256GB SSD. Perfect condition!",
        image: "https://images.unsplash.com/photo-1517336714731-489689fd1ca8?w=400",
        status: "available",
        contact: "john@ku.edu.np",
        createdAt: new Date(2025, 0, 1)
      },
      {
        id: 2,
        title: "Engineering Textbooks Set",
        price: 3500,
        category: "Books",
        description: "Complete set of first-year engineering books. Minimal highlighting.",
        image: "https://images.unsplash.com/photo-1544947950-fa07a98d237f?w=400",
        status: "available",
        contact: "sarah@ku.edu.np",
        createdAt: new Date(2024, 11, 28)
      },
      {
        id: 3,
        title: "Study Desk with Chair",
        price: 4500,
        category: "Furniture",
        description: "Sturdy wooden desk with comfortable chair. Great for dorm room!",
        image: "https://images.unsplash.com/photo-1518455027359-f3f8164ba6bd?w=400",
        status: "sold",
        contact: "mike@ku.edu.np",
        createdAt: new Date(2024, 11, 25)
      },
      {
        id: 4,
        title: "Gaming Mouse & Keyboard",
        price: 2800,
        category: "Electronics",
        description: "RGB gaming peripherals, barely used. Original packaging included.",
        image: "https://images.unsplash.com/photo-1587829741301-dc798b83add3?w=400",
        status: "available",
        contact: "alex@ku.edu.np",
        createdAt: new Date(2024, 11, 30)
      },
      {
        id: 5,
        title: "Scientific Calculator",
        price: 800,
        category: "Stationery",
        description: "Casio fx-991ES Plus calculator. Perfect for engineering students.",
        image: "",
        status: "available",
        contact: "priya@ku.edu.np",
        createdAt: new Date(2025, 0, 2)
      }
    ];

    // ===== Initialize =====
    document.addEventListener('DOMContentLoaded', () => {
      // Load mock data (replace with API call later)
      marketplaceItems = [...mockData];
      renderMarketplaceItems();

      // Event Listeners
      document.getElementById('postItemBtn').addEventListener('click', openPostModal);
      document.getElementById('postItemForm').addEventListener('submit', handlePostItem);
      document.getElementById('searchInput').addEventListener('input', handleSearch);
      document.getElementById('categorySelect').addEventListener('change', handleCategoryFilter);
      
      // Filter buttons
      document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
          e.target.classList.add('active');
          currentFilter = e.target.dataset.filter;
          renderMarketplaceItems();
        });
      });

      // Close modal on outside click
      document.querySelectorAll('.modal').forEach(modal => {
        modal.addEventListener('click', (e) => {
          if (e.target === modal) closeModals();
        });
      });
    });

    // ===== Render Functions =====
    function renderMarketplaceItems() {
      const grid = document.getElementById('marketplaceGrid');
      const loading = document.getElementById('marketplaceLoading');
      const empty = document.getElementById('marketplaceEmpty');

      // Filter items
      let filteredItems = marketplaceItems.filter(item => {
        const matchesFilter = currentFilter === 'all' || item.status === currentFilter;
        const matchesSearch = item.title.toLowerCase().includes(searchQuery.toLowerCase()) ||
                             item.description.toLowerCase().includes(searchQuery.toLowerCase());
        const matchesCategory = !categoryFilter || item.category === categoryFilter;
        return matchesFilter && matchesSearch && matchesCategory;
      });

      // Show/hide states
      loading.style.display = 'none';
      if (filteredItems.length === 0) {
        grid.style.display = 'none';
        empty.style.display = 'block';
      } else {
        grid.style.display = 'grid';
        empty.style.display = 'none';
        
        // Render items
        grid.innerHTML = filteredItems.map(item => `
          <div class="item-card" onclick="showItemDetail(${item.id})">
            <div class="item-image">
              ${item.image ? `<img src="${item.image}" alt="${item.title}">` : '<i class="fas fa-box"></i>'}
            </div>
            <div class="item-info">
              <h3 class="item-title">${item.title}</h3>
              <div class="item-price">NPR ${item.price.toLocaleString()}</div>
              <span class="item-category">${item.category}</span>
              <span class="item-status ${item.status}">${item.status === 'available' ? '✓ Available' : '✕ Sold'}</span>
              <p class="item-desc">${item.description}</p>
              <div class="item-meta">
                <i class="fas fa-clock"></i> ${formatDate(item.createdAt)}
              </div>
            </div>
          </div>
        `).join('');
      }
    }

    // ===== Modal Functions =====
    function openPostModal() {
      document.getElementById('postModal').classList.add('active');
      document.getElementById('itemTitle').focus();
    }

    function closeModals() {
      document.querySelectorAll('.modal').forEach(modal => modal.classList.remove('active'));
      document.getElementById('postItemForm').reset();
    }

    function showItemDetail(itemId) {
      const item = marketplaceItems.find(i => i.id === itemId);
      if (!item) return;

      const content = document.getElementById('detailContent');
      content.innerHTML = `
        <button class="close-modal" aria-label="Close Modal" onclick="closeModals()">&times;</button>
        <div style="text-align: center; margin-bottom: 1.5rem;">
          ${item.image ? `<img src="${item.image}" alt="${item.title}" style="max-width: 100%; border-radius: var(--border-radius); max-height: 300px; object-fit: cover;">` : '<div style="font-size: 5rem; color: var(--gray-light);"><i class="fas fa-box"></i></div>'}
        </div>
        <h2>${item.title}</h2>
        <div style="margin: 1rem 0;">
          <span class="item-price" style="font-size: 1.5rem;">NPR ${item.price.toLocaleString()}</span>
          <span class="item-status ${item.status}" style="margin-left: 1rem;">${item.status === 'available' ? '✓ Available' : '✕ Sold'}</span>
        </div>
        <p style="margin: 1rem 0;"><strong>Category:</strong> ${item.category}</p>
        <p style="margin: 1rem 0;"><strong>Description:</strong></p>
        <p style="color: var(--dark-light); line-height: 1.8;">${item.description}</p>
        <p style="margin: 1.5rem 0;"><strong>Contact:</strong> ${item.contact}</p>
        <p style="color: var(--gray); font-size: 0.9rem;"><i class="fas fa-clock"></i> Posted ${formatDate(item.createdAt)}</p>
      `;
      document.getElementById('detailModal').classList.add('active');
    }

    // ===== Form Handlers =====
    function handlePostItem(e) {
      e.preventDefault();
      
      const newItem = {
        id: Date.now(),
        title: document.getElementById('itemTitle').value,
        price: parseFloat(document.getElementById('itemPrice').value),
        category: document.getElementById('itemCategory').value,
        description: document.getElementById('itemDescription').value,
        image: document.getElementById('itemImage').value,
        status: 'available',
        contact: document.getElementById('contactInfo').value,
        createdAt: new Date()
      };

      // Add to items array (in real app, send to API)
      marketplaceItems.unshift(newItem);
      renderMarketplaceItems();
      closeModals();
      showToast('Item posted successfully!');
    }

    function handleSearch(e) {
      searchQuery = e.target.value;
      renderMarketplaceItems();
    }

    function handleCategoryFilter(e) {
      categoryFilter = e.target.value;
      renderMarketplaceItems();
    }

    // ===== Helper Functions =====
    function formatDate(date) {
      const now = new Date();
      const diff = now - date;
      const days = Math.floor(diff / (1000 * 60 * 60 * 24));
      
      if (days === 0) return 'Today';
      if (days === 1) return 'Yesterday';
      if (days < 7) return `${days} days ago`;
      return date.toLocaleDateString();
    }

    function showToast(message, type = 'success') {
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      toast.innerHTML = `<i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'}"></i> ${message}`;
      document.body.appendChild(toast);
      setTimeout(() => toast.remove(), 3000);
    }
  </script>
</body>
</html>